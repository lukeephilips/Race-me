<%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?key=#{ENV['GOOGLE_MAPS_API_KEY']}&libraries=places" %>

<div class="col s4">
  <div class="card grey lighten-4">
    <div class="card-content black-text">
      <h3>Add a new goal</h3>
      <%= form_for [current_user, @goal] do |f| %>
        <%= f.label :name %>
        <%= f.text_field :name %>

        <%= f.label "Enter a start location for Google maps (ex: Steel Bridge, Portland)" %>
        <%= f.text_field :start_location %>

        <%= f.label "Enter an end location for Google maps (ex: Ross Island Bridge, Portland)" %>
        <%= f.text_field :end_location %>

        <%= label_tag "Invite opponents by email (separate opponents with commas)" %>
        <%= text_field_tag :opponents %>

        <%= f.submit class: 'btn' %>
      <% end %>
    </div>
  </div>
</div>

<script type="text/javascript">
  function initialize_start() {

    var input = document.getElementById('goal_start_location');
    var autocomplete = new google.maps.places.Autocomplete(input);

    initialize_end()
  }
  function initialize_end() {
    var input = document.getElementById('goal_end_location');
    var autocomplete = new google.maps.places.Autocomplete(input);
  }
  google.maps.event.addDomListener(window, 'load', initialize_start);
  google.maps.event.addDomListener(window, 'load', initialize_end);
</script>
